{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(query, currentPage){\n\n    const BASE_URL = 'https://pixabay.com';\n    const END_POINT = '/api/';\n    // const API_KEY = '?key=42368566-c5457d3930466887d9437b3aa';\n    const API_KEY = '42368566-c5457d3930466887d9437b3aa';\n    // const PARAMS_OF_SEARCH = '&image_type=photo&orientation=horizontal&safesearch=true';\n    const params = {\n        key: API_KEY,\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: currentPage,\n        per_page: 15,\n    }\n    const url = `${BASE_URL}${END_POINT}`;\n    const res = await axios.get(url, {params});\n    console.log(res.data);\n    return res.data;\n    // const url = this.BASE_URL + this.END_POINT + this.API_KEY + `&q=${encodeURIComponent(query)}` + this.PARAMS_OF_SEARCH;\n    // return fetch(url).then(res => res.json());\n    \n}","import {gallery} from \"../main\";\nfunction templateImg({webformatURL, largeImageURL, tags, likes, views, comments, downloads}){\n    return `<li class=\"gallery-item\"><a href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"></a>\n    <p><b>Likes: </b>${likes}</p>\n    <p><b>Views: </b>${views}</p>\n    <p><b>Comments: </b>${comments}</p>\n    <p><b>Downloads: </b>${downloads}</p>\n    </li>`;\n};\nfunction templateImgs(imgs){\n    return imgs.map(templateImg).join('');\n};\nexport function renderImgs(imgs){\n    const markup = templateImgs(imgs);\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n}","import { fetchImages } from \"./js/pixabay-api\";\n// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { renderImgs } from \"./js/render-functions\";\n\nconst form = document.querySelector('.form');\nexport const gallery = document.querySelector('.gallery');\nconst userInput = document.querySelector('input');\nconst containerDiv = document.querySelector('.container');\nconst loadButton = document.querySelector('.btn-load')\n// const pixabayAPI = new PixabayAPI();\nconst showLoader = () => {\n    const loader = document.createElement('span');\n    loader.classList.add('loader');\n    containerDiv.append(loader);\n  };\n\nconst removeLoader = () => {\n    const loader = document.querySelector('.loader');\n    if (loader) {\n        loader.remove();\n    }\n};\nconst showLoadBtn = () =>{\n    loadButton.classList.remove(\"hidden\");\n    console.log(page <= maxPage);\n    console.log(\"showLoadBtn\");\n};\nconst removeLoadBtn = () =>{\n    loadButton.classList.add(\"hidden\");\n    console.log(\"removeLoadBtn\");\n    console.log(page <= maxPage);\n};\nconst checkBtnVisible = () =>{\n    if(page >= maxPage){\n        removeLoadBtn();\n    }else{\n        showLoadBtn();\n\n    }\n}\nlet query;\nlet page;\nlet maxPage;\n\nconst options = {\n    captions: true,\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    animation: 250,\n};\n\nform.addEventListener(\"submit\", onFormSubmit);\nloadButton.addEventListener(\"click\", loadMore);\n\nasync function onFormSubmit(e){\n    e.preventDefault();\n    query = userInput.value.trim();\n    page = 1;\n\n    if(!query){\n        showError('Empty field!');\n        return;\n    }\n    showLoader();\n\n    try{\n        const data = await fetchImages(query,page);\n        if(data.totalHits === 0){\n            showError(\"Sorry, there are no images matching your search query. Please try again!\")\n        };\n        maxPage = Math.ceil(data.totalHits / 15);\n        gallery.innerHTML = \"\";\n        renderImgs(data.hits);\n        const lightbox = new SimpleLightbox('.gallery a', options);\n        lightbox.on('show.sipmlelightbox');\n        lightbox.refresh();\n    \n    }\n    catch(err){\n        showError(err);\n    }\n    removeLoader();\n    checkBtnVisible();\n    form.reset();\n};\nasync function loadMore(e){\n    page += 1;\n    const data = await fetchImages(query,page);\n    renderImgs(data.hits);\n    const lightbox = new SimpleLightbox('.gallery a', options);\n    lightbox.on('show.sipmlelightbox');\n    lightbox.refresh();\n    removeLoader();\n    checkBtnVisible();\n    const heights = gallery.firstElementChild.getBoundingClientRect().height;\n    scrollBy({\n        behavior: 'smooth',\n        top: 2*heights,\n      });\n    if(page >= maxPage){\n        iziToast.info({\n            title: '',\n            message: \"We're sorry, but you've reached the end of search results.\",\n    })\n    }\n}\n\nfunction showError(msg) {\n    iziToast.error({\n        title: 'Error',\n        message: msg,\n    });\n    }"],"names":["fetchImages","query","currentPage","BASE_URL","END_POINT","params","url","res","axios","templateImg","webformatURL","largeImageURL","tags","likes","views","comments","downloads","templateImgs","imgs","renderImgs","markup","gallery","form","userInput","containerDiv","loadButton","showLoader","loader","removeLoader","showLoadBtn","page","maxPage","removeLoadBtn","checkBtnVisible","options","onFormSubmit","loadMore","showError","data","lightbox","SimpleLightbox","err","heights","iziToast","msg"],"mappings":"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"}